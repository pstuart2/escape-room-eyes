<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Babylon Template</title>

    <style>
        html, body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #renderCanvas {
            width: 100%;
            height: 100%;
            touch-action: none;
        }
    </style>

    <script src="//cdn.babylonjs.com/babylon.js"></script>
    <script src="//code.jquery.com/pep/0.4.1/pep.js"></script>

</head>

<body>

<canvas id="renderCanvas" touch-action="none"></canvas>
//touch-action="none" for best results from PEP

<script>

    var canvas = document.getElementById("renderCanvas"); // Get the canvas element

    var engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine

    BABYLON.SceneLoader.Load("/assets/", "EyeBall.babylon", engine, function (newScene) {

    	// Wait for textures and shaders to be ready
        newScene.executeWhenReady(function () {
            var rightEye = newScene.getMeshByName('Eye.R');
            var leftEye = newScene.getMeshByName('Eye.L');

            console.log(rightEye.rotation);

            var startX = 0;

            var lookDownAnimation = new BABYLON.Animation('lookDown', 'rotation.x', 30, BABYLON.Animation.ANIMATIONTYPE_FLOAT, BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);
            var keys = [];
            keys.push({frame: 0, value: startX});
            keys.push({frame: 25, value: startX + -1});
            keys.push({frame: 50, value: startX});
            lookDownAnimation.setKeys(keys);

            var easingFunction = new BABYLON.QuarticEase();
            easingFunction.setEasingMode(BABYLON.EasingFunction.EASINGMODE_EASEINOUT);
            lookDownAnimation.setEasingFunction(easingFunction);

            rightEye.animations = [];
            rightEye.animations.push(lookDownAnimation);

            leftEye.animations = [];
            leftEye.animations.push(lookDownAnimation);

            newScene.beginAnimation(rightEye, 0, 50, true);
            newScene.beginAnimation(leftEye, 0, 50, true);

            // Attach camera to canvas inputs
            newScene.activeCamera.attachControl(canvas);

            newScene.autoClear = true;
            newScene.clearColor = BABYLON.Color4.FromHexString('#252524ff');

            // Once the scene is loaded, just register a render loop to render it
            engine.runRenderLoop(function() {
                //console.log(rightEye.rotation);

                newScene.render();
            });
        });
    });

    window.addEventListener("resize", function () { // Watch for browser/canvas resize events
        engine.resize();
    });
</script>

</body>

</html>